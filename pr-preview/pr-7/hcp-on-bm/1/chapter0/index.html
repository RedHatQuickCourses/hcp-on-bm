<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Introduction to OpenShift HCP and the PoC Environment :: Hosted Control Planes on a Single Bare Metal Node</title>
    <link rel="prev" href="../LABENV/index.html">
    <link rel="next" href="../chapter1/index.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Hosted Control Planes on a Single Bare Metal Node</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/hcp-on-bm/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="hcp-on-bm" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Hosted Control Planes on a Single Bare Metal Node</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="index.html">Introduction to OpenShift HCP and the PoC Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../chapter1/index.html">Deploy the Bare Metal Node</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../chapter2/index.html">Prepare the Bare Metal Node</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../chapter3/index.html">Setup the Hub Cluster</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../chapter4/index.html">Add Managed Hosts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../chapter5/index.html">Create and Access a Hosted Cluster</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../chapter6/index.html">Closing Words</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/index.html">Optional: Configure Virtual BMC Services on the Bare Metal Host</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Hosted Control Planes on a Single Bare Metal Node</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Hosted Control Planes on a Single Bare Metal Node</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Hosted Control Planes on a Single Bare Metal Node</a></li>
    <li><a href="index.html">Introduction to OpenShift HCP and the PoC Environment</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Introduction to OpenShift HCP and the PoC Environment</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This section introduces the essential concepts and terminology of OpenShift Hosted Control Planes (HCP) and describes the proof-of-concept (PoC) environment that you will deploy in the activities of this course.</p>
</div>
<div class="paragraph">
<p><em>Watch the following video and then read the introduction section.</em></p>
</div>
<iframe type="text/javascript" src='https://cdnapisec.kaltura.com/p/2032581/embedPlaykitJs/uiconf_id/49478072?iframeembed=true&entry_id=1_c8kboedg' style="width: 768px; height: 432px" allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" frameborder="0"></iframe>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Red Hat One videos are available only to Red Hat employees. If you have issues watching the video embedded in this page, watch it directly on the <a href="https://videos.learning.redhat.com/media/hcp-on-bm-intro/1_79vnk220" target="_blank" rel="noopener">Red Hat media space</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_are_hosted_control_planes"><a class="anchor" href="#_what_are_hosted_control_planes"></a>What are Hosted Control Planes?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hosted Control Planes is a cloud-native architecture where the OpenShift control plane is decoupled from its data plane. The control planes of multiple OpenShift clusters run as pods on a single OpenShift cluster.</p>
</div>
<div class="paragraph">
<p>HCP uses the upstream project HyperShift and the MultiCluster Engine (MCE) operator. HCP can be co-hosted on an ACM hub cluster or on a dedicated OpenShift cluster.</p>
</div>
<div class="paragraph">
<p>HCP increases return on investment by using common hardware to run multiple control planes and allowing a higher server density. Without HCP, hardware resources are underutilized on master nodes, especially when you do not wish to share those nodes with user workloads.</p>
</div>
<div class="paragraph">
<p>We will see how Hosted control planes can increase ROI. In this example, there are 4 OpenShift clusters. One management cluster and 3 application clusters.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/fig-1.svg" alt="fig 1">
</div>
<div class="title">Figure 1. Multiple OpenShift clusters, without HCP</div>
</div>
<div class="paragraph">
<p>All four clusters are having 3 dedicated master nodes and a few infra and workers nodes. In this case, without HCP, total 40 nodes are required to serve 4 OpenShift clusters.</p>
</div>
<div class="paragraph">
<p>Now with hosted control planes feature: the control planes of all 3 clusters are running as pods in the management cluster. Infra and worker nodes remains same. The management cluster has 3 control plane + 3 infra nodes same as earlier. But, in application clusters, the 3 control plane nodes are not required. So, in total, 31 nodes are sufficient to have 4 OpenShift clusters, whereas without HCP, 40 nodes were required.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/fig-2.svg" alt="fig 2">
</div>
<div class="title">Figure 2. Multiple OpenShift clusters, using HCP</div>
</div>
<div class="paragraph">
<p>Letâ€™s deep dive into a sample HCP architecture. In HCP, the cluster on which control planes run is called the <em>host cluster</em>. In this architecture, the host cluster is same as the OpenShift management cluster which runs the ACM hub. The ACM, MCE, and HyperShift operators run on the host cluster, which is a standard OpenShift cluster with three 3 schedulable masters and 3 infra nodes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/fig-3.png" alt="fig 3">
</div>
<div class="title">Figure 3. HCP architecture with single host/hub cluster</div>
</div>
<div class="paragraph">
<p>In continuation to the previous example, there are 3 application clusters, each one on its own namespace on the host cluster. HCP pods, api-server, auth-server, etcd, olm, and other control plane pods run in each of these namespaces. On the data plane side, the first cluster has AWS EC2 instances as workers; the second cluster has bare metal nodes running on their data-center as worker nodes; and the third cluster has OpenShift Virtualization VMs, hosted by the ACM hub cluster, as worker nodes.</p>
</div>
<div class="paragraph">
<p>Another architecture for HCP has a dedicated ACM hub cluster and multiple managed clusters acting as host clusters.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/fig-4.png" alt="fig 4">
</div>
<div class="title">Figure 4. HCP architecture with single hub cluster and multiple host clusters</div>
</div>
<div class="paragraph">
<p>This architecture offers greater scalability because the number of hosted clusters is not limited by the capacity of the ACM hub cluster. The hub cluster manages both host clusters and hosted clusters. On each host cluster, there is a separate instance of the MCE, which is not self managed, but it is managed by the ACM hub. The ACM hub also manages the data planes of each hosted cluster, which again can reside on different kinds of infrastructure, from IaaS cloud instances to physical servers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_hosted_control_planes"><a class="anchor" href="#_why_hosted_control_planes"></a>Why Hosted Control Planes ?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following are a few use cases where Hosted Control Planes is a good fit:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Hybrid cloud adoption</dt>
<dd>
<p>Deploy applications across multiple cloud providers or hybrid cloud environments.</p>
</dd>
<dt class="hdlist1">Edge and IoT applications</dt>
<dd>
<p>Edge computing and IoT applications that require a lightweight, flexible platform to manage distributed systems</p>
</dd>
<dt class="hdlist1">OCP as a managed service</dt>
<dd>
<p>Increase ROI by running multiple control planes on pods instead of dedicated nodes.</p>
<div class="paragraph">
<p>Offer OpenShift as a managed service to customers where customers do not need to manage the control plane.</p>
</div>
</dd>
<dt class="hdlist1">Startups or fast growing organizations</dt>
<dd>
<p>HCP clusters data plane can be created using OpenShift Virtualization.</p>
<div class="paragraph">
<p>Cluster creation and adding more clusters is faster and cheaper with HCP and OpenShift Virtualization VMs.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_planing_pocs_and_testing_hosted_control_planes"><a class="anchor" href="#_planing_pocs_and_testing_hosted_control_planes"></a>Planing PoCs and Testing Hosted Control Planes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most customers are planning to use bare metal servers, but they may not have enough physical servers available for a proof-of-concept (PoC), or may not be able to provide such servers in a timely manner.</p>
</div>
<div class="paragraph">
<p>You see, a text-book deployment of HCP requires 6 servers for the hub/host cluster alone (3 masters + 3 infra nodes) and additional servers for worker nodes of hosted clusters. Even if you attempt to use a compact cluster (3 schedulable masters and no infra nodes) you still require a minimum of five servers for creating a single hosted cluster with two nodes.</p>
</div>
<div class="paragraph">
<p>To work around availability of servers, and still perform a successful PoC, you can use RHEL virtualization, based on KVM and libvirt, to emulate multiple bare metal servers on a single physical server, or on a smaller number of servers that would be required to provide dedicated servers for a hub/host cluster + dedicated servers for worker nodes/data plane nodes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/diagram-full.svg" alt="diagram full">
</div>
<div class="title">Figure 5. PoC environment for HCP using a single server and libvirt VMs</div>
</div>
<div class="paragraph">
<p>By following the activities in this course, you will first use a set of provided Ansible playbooks to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure the bare metal host and a helper services VM, to provide DHCP, BOOTP, and load balancer services.</p>
</li>
<li>
<p>Configure a set of six libvirt VMs as a hub and host cluster.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then you will use the OpenShift web console to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure an ACM infrastructure environment and add VMs as physical hosts to that environment.</p>
</li>
<li>
<p>Create a hosted cluster using those VMs as worker nodes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And you will use the OpenShift CLI to access the new hosted cluster, in addition to its own web console.</p>
</div>
<div class="paragraph">
<p>You will also experiment with different ways of provisioning your physical hosts and adding them to an infrastructure environment, including optional virtual BMC services to demonstrate the usage of managed server hardware as part of your HCP deployments.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../LABENV/index.html">Lab Environment</a></span>
  <span class="next"><a href="../chapter1/index.html">Deploy the Bare Metal Node</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
